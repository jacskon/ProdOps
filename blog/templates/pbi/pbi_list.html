{% extends "blog/../base.html" %}
{% load staticfiles %}
{% block menu_links %}
    <a href="{% url 'pbi_new' %}" class="top-menu"><span class="glyphicon glyphicon-plus"></span></a>
{% endblock %}
{% block headers %}
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script src="http://code.highcharts.com/highcharts.js"></script>
{% endblock %}
{% block content %}
    <table id="pbi"  class="table table-striped table-bordered table-hover">
        <tr>
            <th>PBI Number</th>
            <th>Description</th>
            <th>Status</th>
            <th>Priority</th>
            <th>Asignee</th>
            <th>ETA</th>
            <th>Next Action</th>
            <th></th>
        </tr>
        {% for problem in pbi %}
            <tr>
                <td>{{ problem.number }}</td>
                <td>{{ problem.description }}</td>
                <td>{{ problem.status }}</td>
                <td>{{ problem.severity }}</td>
                <td>{{ problem.assignee }}</td>
                {% if problem.estimated_finish == None %}
                    <td>TBC</td>
                {% else %}
                    <td>{{ problem.estimated_finish }}</td>
                {% endif %}
                <td>{{ problem.next_action }}</td>
                <td style="text-align: center; word-spacing: 3px;"><a href="{% url "pbi_remove" pk=problem.pk %}"><span class="glyphicon glyphicon-remove"></span>  <a href="{% url "pbi_edit" pk=problem.pk %}"><span class="glyphicon glyphicon-edit"></span></td>
            </tr>
        {% endfor %}
        </tr>
    </table>
    <table id="pbi"  class="table table-striped table-bordered table-hover">
    <tr>
        <th>Task</th>
        <th>Monday</th>
        <th>Tuesday</th>
        <th>Wednesday</th>
        <th>Thursday</th>
        <th>Friday</th>
        <th>Saturday</th>
        <th>Sunday</th>
    </tr>
    <tr>
        <th>
            On Call
        </th>
        {% for on_caller in task_list %}
            {% if on_caller.task == "On call" %}
                {% for i in "xxxxxxx" %}
                    <td><a href="{% url "task_edit" pk=on_caller.pk %}" class="pbi-link">{{ on_caller.user }}</a></td>
                {% endfor %}
            {% endif %}
        {% endfor %}
    </tr>
    <tr>
        <th>
            Morning Shift
        </th>
        {% for tasker in task_list %}
            {% if tasker.task == "Monday Morning Health Check" %}
                <td><a href="{% url "task_edit" pk=tasker.pk %}" class="pbi-link">{{ tasker.user }}</a></td>
            {% endif %}
            {% if tasker.task == "Tuesday Morning Health Check" %}
                <td><a href="{% url "task_edit" pk=tasker.pk %}" class="pbi-link">{{ tasker.user }}</a></td>
            {% endif %}
            {% if tasker.task == "Wednesday Morning Health Check" %}
                <td><a href="{% url "task_edit" pk=tasker.pk %}" class="pbi-link">{{ tasker.user }}</a></td>
            {% endif %}
            {% if tasker.task == "Thursday Morning Health Check" %}
                <td><a href="{% url "task_edit" pk=tasker.pk %}" class="pbi-link">{{ tasker.user }}</a></td>
            {% endif %}
            {% if tasker.task == "Friday Morning Health Check" %}
                <td><a href="{% url "task_edit" pk=tasker.pk %}" class="pbi-link">{{ tasker.user }}</a></td>
            {% endif %}
        {% endfor %}
        <td></td>
        <td></td>
    </tr>
    <tr>
        <th>
            Evening Shift
        </th>
        {% for tasker in task_list %}
            {% if tasker.task == "Monday evening Standby" %}
                <td><a href="{% url "task_edit" pk=tasker.pk %}" class="pbi-link">{{ tasker.user }}</a></td>
            {% endif %}
            {% if tasker.task == "Tuesday evening Standby" %}
                <td><a href="{% url "task_edit" pk=tasker.pk %}" class="pbi-link">{{ tasker.user }}</a></td>
            {% endif %}
            {% if tasker.task == "Wednesday evening Restarts" %}
                <td><a href="{% url "task_edit" pk=tasker.pk %}" class="pbi-link">{{ tasker.user }}</a></td>
            {% endif %}
            {% if tasker.task == "Thursday evening Standby" %}
                <td><a href="{% url "task_edit" pk=tasker.pk %}" class="pbi-link">{{ tasker.user }}</a></td>
            {% endif %}
            {% if tasker.task == "Friday evening Standby" %}
                <td><a href="{% url "task_edit" pk=tasker.pk %}" class="pbi-link">{{ tasker.user }}</a></td>
            {% endif %}
        {% endfor %}
        <td></td>
        <td></td>
    </tr>
    </table>
    <div id="container1" style="min-width: 310px; height: 350px; max-width: 600px; margin-right: 100px auto"></div>
    <div id="container" style="min-width: 310px; height: 350px; max-width: 600px; margin-right: 100px auto"></div>
    <table class="pbi_summary table table-striped table-bordered table-hover">
        <tr>
            <th>Priority</th>
            <th>Count</th>
        </tr>
        <tr>
            <td>Critical</td>
            <td>{{ critical_sum }}</td>
        </tr>
        <tr>
            <td>High</td>
            <td>{{ high_sum }}</td>
        </tr>
        <tr>
            <td>Medium</td>
            <td>{{ medium_sum }}</td>
        </tr>
        <tr>
            <td>Low</td>
            <td>{{ low_sum }}</td>
        </tr>
    </table>
    <table class="pbi_summary table table-striped table-bordered table-hover">
        <tr>
            <th>Status</th>
            <th>Count</th>
        </tr>
        <tr>
            <td>Assigned</td>
            <td>{{ assigned_sum }}</td>
        </tr>
        <tr>
            <td>Under investigation</td>
            <td>{{ under_investigation_sum }}</td>
        </tr>
        <tr>
            <td>In Progress</td>
            <td>{{ in_progress_sum }}</td>
        </tr>
        <tr>
            <td>Pending</td>
            <td>{{ pending_sum   }}</td>
        </tr>
    </table>

    <button id="hide">Hide</button>
    <button id="show">Show</button>
    <script>

$(document).ready(function(){
    $("#hide").click(function(){
        $(".page-header").hide();
        $(".page-header-space").show();
    });
    $("#show").click(function(){
        $(".page-header").show();
        $(".page-header-space").hide();
    });
});

$(function () {

    $(document).ready(function () {

        // Build the chart
        $('#container').highcharts({
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: true,
                type: 'pie'
            },
            title: {
                text: 'Priority'
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: false
                    },
                    showInLegend: true
                }
            },
            series: [{
                name: "Priorities",
                colorByPoint: true,
                data: [{
                    name: "Crtitical",
                    y: {{ critical_sum }}
                }, {
                    name: "High",
                    y: {{ high_sum }},
                    sliced: true,
                    selected: true
                }, {
                    name: "Medium",
                    y: {{ medium_sum }}
                }, {
                    name: "Low",
                    y: {{ low_sum }}
                }]
            }]
        });
    });
});
$(function () {

    $(document).ready(function () {

        // Build the chart
        $('#container1').highcharts({
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: true,
                type: 'pie'
            },
            title: {
                text: 'Status'
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: false
                    },
                    showInLegend: true
                }
            },
            series: [{
                name: "Status",
                colorByPoint: true,
                data: [{
                    name: "Assigned",
                    y: {{ assigned_sum }}
                }, {
                    name: "Under investigation",
                    y: {{ under_investigation_sum }},
                    sliced: true,
                    selected: true
                }, {
                    name: "In progress",
                    y: {{ in_progress_sum }}
                }, {
                    name: "Pending",
                    y: {{ pending_sum }}
                }]
            }]
        });
    });
});
	</script>
{% endblock content %}